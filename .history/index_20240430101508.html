<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        .grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 0px;
        }
    </style>

    <title>Android Yata组件化性能测试报告</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body onload="main()">
    <h2>Android Yata组件化性能测试报告</h2>

    <div id="grid-container" class="grid"></div>

    <script>

        function main() {
            const durationType = [
                "yata_store_tree_build_timing_duration", 
                "yata_store_tree_update_timing_duration", 
                "yata_view_upscreen_timing_duration"
            ];
       
            const paramData = {
                "biz_code": "yata_sku",
                "scene": "biz_first_enter",
                "yata_store_tree_build_timing_duration": {
                    "v11": [
                        3,
                        1
                    ],
                    "v12": [
                        4,
                        1
                    ],
                    "v13": [
                        4,
                        1
                    ]
                },
                "yata_store_tree_update_timing_duration": {
                    "v11": [
                        0,
                        0
                    ],
                    "v12": [
                        0,
                        0
                    ],
                    "v13": [
                        0,
                        0
                    ]
                },
                "yata_view_upscreen_timing_duration": {
                    "v11": [
                        189,
                        107
                    ],
                    "v12": [
                        203,
                        105
                    ],
                    "v13": [
                        197,
                        100
                    ]
                }
            };
        
            for (var i = 0; i < durationType.length; i++) {
                let type = durationType[i];
                console.log('print type:-----' + type);
                let durationData = paramData[type];
                console.log('data' + durationData);
                let title = paramData['biz_code']+'_'+paramData['scene']+'_'+type;
                drawChart(title, durationData);
            }
        }

        function drawChart(title, durationData) {
            //整理数据     
            let dataArray = [];
            Object.keys(durationData).forEach(key => {
                let yValue = durationData[key];
                let xValue = [];
                for (let i = 1; i <= yValue.length; i++) {
                    xValue.push(i);
                }
                dataArray.push({
                    x: xValue,
                    y: yValue,
                    type: 'line',
                    name: key
                })
            });

            //画图
            let container = document.getElementById('grid-container');
            //region addView
            let div = document.createElement('div');
            let viewId = "chart" + title;
            div.id = viewId;
            container.appendChild(div);
            Plotly.newPlot(viewId, dataArray, layout = {
                title: title,
                xaxis: {
                    title: "次数"
                },
                yaxis: {
                    title: "耗时/ms"
                }
            })
        }

        function convertToCN(content){
            return content.replace('yata_sku', 'SKU')
        }
    </script>
</body>

</html>